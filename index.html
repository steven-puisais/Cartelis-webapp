<html>

	<head>
		<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
		<link href="style.css" rel="stylesheet" type="text/css">
	</head>
	<body>
		<script src="https://apis.google.com/js/api.js"></script>
		<script>
			sheets = []
			function authenticate() {
				return gapi.auth2.getAuthInstance()
					.signIn({ scope: "https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/spreadsheets https://www.googleapis.com/auth/drive.file" })
					.then(function () { console.log("Sign-in successful"); },
						function (err) { console.error("Error signing in", err); });
			}
			function loadClient() {
				gapi.client.setApiKey("AIzaSyDH0SldII1P_YP1NcKwPAH_p7qDSSdQA28");
				return gapi.client.load("https://content.googleapis.com/discovery/v1/apis/drive/v3/rest")
					.then(function () 
					{ 
						console.log("GAPI client loaded for API"); 
						document.getElementById("connect_button").style.display = "none";
						document.getElementById("dropdown_list").style.display = "inline";
						execute();
					},
					function (err) 
					{ 
						console.error("Error loading GAPI client for API", err); 
					});
			}
			// Make sure the client is loaded and sign-in is complete before calling this method.
			function execute() {
				return gapi.client.drive.files.list({})
					.then(function (response) 
					{
						response.result.files.forEach(function(entry) 
						{
							if(entry.mimeType == "application/vnd.google-apps.spreadsheet")
							{
								sheet = {
										"id" : entry.id,
										"name": entry.name
										}
								sheets.push(sheet);
							}
						});
						console.log(sheets);
						var dropdown_list = document.getElementById('dropdown_list');
						sheets.forEach(function(entry)
						{
							var opt = document.createElement('option');
							opt.appendChild( document.createTextNode(entry.name) );
							opt.value = entry.name; 
							dropdown_list.appendChild(opt); 
						});
					},
					function (err) 
					{ 
						console.error("Execute error", err); 
					});
			}
			gapi.load("client:auth2", function () {
				gapi.auth2.init({ client_id: "613313973525-ruv23jes3e7vii6brjdosld874t59vbm.apps.googleusercontent.com" });
			});
		</script>
		<button id="connect_button" onclick="authenticate().then(loadClient)">Connect API</button>
		<select id="dropdown_list" name="sheets">
			<option value="none">None</option>
		</select>
	</body>

</html>